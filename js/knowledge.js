/**
 * Knowledge Hub Logic
 * Handles dynamic content rendering without needing a backend or multiple HTML files.
 */
'use strict';

const KnowledgeApp = {
    // Content Database
    topics: {
        'intro': {
            title: '‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏†‡∏≤‡∏©‡∏µ‡∏â‡∏ö‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡πÉ‡∏´‡∏°‡πà',
            content: `
                <p>‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏†‡∏≤‡∏©‡∏µ (Tax Knowledge Hub) ‡πÅ‡∏´‡∏•‡πà‡∏á‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏†‡∏≤‡∏©‡∏µ‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏á‡πà‡∏≤‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì</p>
                <div class="highlight-box">
                    <h3>‡∏ó‡∏≥‡πÑ‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏†‡∏≤‡∏©‡∏µ?</h3>
                    <p>‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏†‡∏≤‡∏©‡∏µ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏ö‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏†‡∏≤‡∏©‡∏µ ‡πÅ‡∏ï‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡∏ó‡∏≤‡∏á‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡πÉ‡∏ô‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</p>
                </div>
                <h3>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏à‡∏≤‡∏Å‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ:</h3>
                <ul>
                    <li><a href="#" onclick="KnowledgeApp.loadTopic('income-types', event)">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏î‡πâ 40(1)-40(8)</a> - ‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÅ‡∏ö‡∏ö‡πÑ‡∏´‡∏ô?</li>
                    <li><a href="#" onclick="KnowledgeApp.loadTopic('deductions', event)">‡∏Ñ‡πà‡∏≤‡∏•‡∏î‡∏´‡∏¢‡πà‡∏≠‡∏ô</a> - ‡πÉ‡∏ä‡πâ‡∏≠‡∏∞‡πÑ‡∏£‡∏•‡∏î‡∏´‡∏¢‡πà‡∏≠‡∏ô‡πÑ‡∏î‡πâ‡∏ö‡πâ‡∏≤‡∏á?</li>
                    <li><a href="#" onclick="KnowledgeApp.loadTopic('funds', event)">‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô</a> - SSF vs RMF ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏∞‡πÑ‡∏£‡∏î‡∏µ?</li>
                </ul>
            `
        },
        'income-types': {
            title: '‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏î‡πâ 40(1) - 40(8)',
            content: `
                <p>‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡πÑ‡∏ó‡∏¢‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏î‡πâ‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô 8 ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó ‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏≤ 40 ‡∏ã‡∏∂‡πà‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏´‡∏±‡∏Å‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô</p>
                
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th>
                            <th>‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢</th>
                            <th>‡∏´‡∏±‡∏Å‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>40(1) ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</strong></td>
                            <td>‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô, ‡πÇ‡∏ö‡∏ô‡∏±‡∏™, ‡∏ö‡∏≥‡πÄ‡∏´‡∏ô‡πá‡∏à‡∏ö‡∏≥‡∏ô‡∏≤‡∏ç</td>
                            <td>50% ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 100,000 ‡∏ö‡∏≤‡∏ó</td>
                        </tr>
                        <tr>
                            <td><strong>40(2) ‡∏£‡∏±‡∏ö‡∏à‡πâ‡∏≤‡∏á</strong></td>
                            <td>‡∏Ñ‡πà‡∏≤‡∏ô‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤, ‡∏ü‡∏£‡∏µ‡πÅ‡∏•‡∏ô‡∏ã‡πå, ‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</td>
                            <td>50% ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 100,000 ‡∏ö‡∏≤‡∏ó (‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ö 40(1))</td>
                        </tr>
                        <tr>
                            <td><strong>40(3) ‡∏Ñ‡πà‡∏≤‡∏•‡∏¥‡∏Ç‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå</strong></td>
                            <td>‡∏Ñ‡πà‡∏≤‡∏•‡∏¥‡∏Ç‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå, Goodwill</td>
                            <td>50% ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 100,000 ‡∏ö‡∏≤‡∏ó</td>
                        </tr>
                         <tr>
                            <td><strong>40(6) ‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û‡∏≠‡∏¥‡∏™‡∏£‡∏∞</strong></td>
                            <td>‡∏´‡∏°‡∏≠, ‡∏ó‡∏ô‡∏≤‡∏¢, ‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£, ‡∏™‡∏ñ‡∏≤‡∏õ‡∏ô‡∏¥‡∏Å, ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ, ‡∏õ‡∏£‡∏∞‡∏ì‡∏µ‡∏ï‡∏®‡∏¥‡∏•‡∏õ‡∏Å‡∏£‡∏£‡∏°</td>
                            <td>30% (‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ) ‡∏´‡∏£‡∏∑‡∏≠ 60% (‡∏´‡∏°‡∏≠)</td>
                        </tr>
                        <tr>
                            <td><strong>40(8) ‡∏≠‡∏∑‡πà‡∏ô‡πÜ</strong></td>
                            <td>‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≤‡∏¢, Online, YouTuber</td>
                            <td>60% (‡πÄ‡∏´‡∏°‡∏≤) ‡∏´‡∏£‡∏∑‡∏≠ ‡∏ï‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á</td>
                        </tr>
                    </tbody>
                </table>
                <p><em>*‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó 4, 5, 7 ‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏≤‡∏á</em></p>
            `
        },
        'funds': {
            title: '‡∏õ‡∏£‡∏∞‡∏ä‡∏±‡∏ô‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô: SSF vs RMF vs TESG',
            content: `
                <p>‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡∏•‡∏î‡∏´‡∏¢‡πà‡∏≠‡∏ô‡∏†‡∏≤‡∏©‡∏µ ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÑ‡∏î‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡∏ó‡∏≤‡∏á‡∏†‡∏≤‡∏©‡∏µ</p>
                <div style="overflow-x: auto;">
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠</th>
                                <th>SSF (‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡∏£‡∏ß‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏°)</th>
                                <th>RMF (‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡∏£‡∏ß‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏ä‡∏µ‡∏û)</th>
                                <th>TESG (Thai ESG)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>‡∏ß‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡∏î‡∏´‡∏¢‡πà‡∏≠‡∏ô</strong></td>
                                <td>30% ‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 200,000</td>
                                <td>30% ‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 500,000</td>
                                <td>30% ‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 100,000</td>
                            </tr>
                            <tr>
                                <td><strong>‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠</strong></td>
                                <td>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥</td>
                                <td>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥</td>
                                <td>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥</td>
                            </tr>
                            <tr>
                                <td><strong>‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏ñ‡∏∑‡∏≠‡∏Ñ‡∏£‡∏≠‡∏á</strong></td>
                                <td>10 ‡∏õ‡∏µ‡πÄ‡∏ï‡πá‡∏° (‡∏ô‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ä‡∏ô‡∏ß‡∏±‡∏ô)</td>
                                <td>‡∏ñ‡∏∑‡∏≠ 5 ‡∏õ‡∏µ + ‡∏≠‡∏≤‡∏¢‡∏∏‡∏Ñ‡∏£‡∏ö 55 ‡∏õ‡∏µ</td>
                                <td>8 ‡∏õ‡∏µ‡πÄ‡∏ï‡πá‡∏°</td>
                            </tr>
                            <tr>
                                <td><strong>‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô</strong></td>
                                <td>‡∏ó‡∏∏‡∏Å‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏ó‡∏±‡πà‡∏ß‡πÇ‡∏•‡∏Å</td>
                                <td>‡∏ó‡∏∏‡∏Å‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏ó‡∏±‡πà‡∏ß‡πÇ‡∏•‡∏Å</td>
                                <td>‡∏´‡∏∏‡πâ‡∏ô/‡∏ï‡∏£‡∏≤‡∏™‡∏≤‡∏£‡∏´‡∏ô‡∏µ‡πâ ESG ‡πÉ‡∏ô‡πÑ‡∏ó‡∏¢</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            `
        },
        'docs': {
            title: '‡πÄ‡∏ä‡πá‡∏Ñ‡∏•‡∏¥‡∏™‡∏ï‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏∑‡πà‡∏ô‡∏†‡∏≤‡∏©‡∏µ',
            content: `
                <h3>üìÅ ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ</h3>
                <ul>
                    <li><input type="checkbox" disabled> <strong>‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á 50 ‡∏ó‡∏ß‡∏¥</strong> (‡∏à‡∏≤‡∏Å‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó/‡∏ô‡∏≤‡∏¢‡∏à‡πâ‡∏≤‡∏á)</li>
                    <li><input type="checkbox" disabled> ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏±‡∏ô‡∏ú‡∏•‡∏´‡∏∏‡πâ‡∏ô (‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏†‡∏≤‡∏©‡∏µ)</li>
                </ul>

                <h3>üìÅ ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏Ñ‡πà‡∏≤‡∏•‡∏î‡∏´‡∏¢‡πà‡∏≠‡∏ô</h3>
                <ul>
                    <li><input type="checkbox" disabled> ‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï/‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û</li>
                    <li><input type="checkbox" disabled> ‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ö‡πâ‡∏≤‡∏ô (‡∏à‡∏≤‡∏Å‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£)</li>
                    <li><input type="checkbox" disabled> ‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô SSF/RMF</li>
                    <li><input type="checkbox" disabled> ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏à‡∏≤‡∏Ñ (e-Donation ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©)</li>
                </ul>
            `
        }
    },

    init() {
        // Load initial topic from URL hash or default to 'intro'
        const hash = window.location.hash.substring(1);
        this.loadTopic(hash || 'intro');

        // Handle browser back button
        window.addEventListener('hashchange', () => {
            const newHash = window.location.hash.substring(1);
            this.loadTopic(newHash || 'intro');
        });
    },

    loadTopic(topicKey, event) {
        if (event) event.preventDefault();

        const topic = this.topics[topicKey];
        if (!topic) return;

        // Update Content
        document.getElementById('articleTitle').textContent = topic.title;
        document.getElementById('articleBody').innerHTML = topic.content;

        // Update URL
        window.history.pushState(null, null, `#${topicKey}`);

        // Update Active Sidebar Link
        document.querySelectorAll('.sidebar-link').forEach(link => {
            link.classList.remove('active');
            if (link.dataset.topic === topicKey) {
                link.classList.add('active');
            }
        });

        // Scroll to top
        window.scrollTo(0, 0);
    }
};

document.addEventListener('DOMContentLoaded', () => {
    KnowledgeApp.init();
});
